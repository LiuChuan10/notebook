目录
1.	简介	4
1.1	编写目的【必须】	4
1.2	需求背景【必须】	4
1.3	需求分析【必须】	5
1.4	术语和缩写【必须】	5
1.5	参考资料【必须】	5
2.	总体架构	5
2.1	系统说明【必须】	5
2.2	运行环境【必须】	6
2.3	总体结构及模块划分【必须】	7
2.4	资源消耗【必须】	8
2.5	尚未解决的问题【必须】	9
3.	DFX属性设计	9
3.1	可测试性【必须】	9
3.2	维护【必须】	9
3.3	可配置设计【选填，DSP 、BSP涉及，APP不涉及】	9
3.4	安全设计【必须】	10
3.5	可制造性【必须】	10
4.	模块概要说明	10
4.1	文件管理描述	10
4.1.1	框架设计以及处理流程【必须】	11
4.1.2	子模块划分列表	13
4.1.3	子模块设计说明	13
4.1.4	内部接口	13
4.1.5	异常处理	14
4.2	回放筛选描述	14
4.2.1	功能框架设计以及处理流程	14
4.2.2	子模块划分列表	14
4.2.3	子模块设计说明	14
4.2.4	内部接口	14
4.2.5	异常处理	15
5.	对外接口	15
6.	参数结构	15
6.1.1	全局变量	15
6.1.2	结构体	15
7.	异常处理	15
8.	修订记录【必须】	15


1.	简介
本模板是为了提高开发人员的工作效率，在概要设计阶段就把功能需要涉及的多个模块考虑清楚，让各个模块负责人参与到讨论中来，把功能的数据流过程理清楚，提前把需要模块提供的对外接口定义出来，在接口的基础上各个模块开发人员并行的开发，减少开发时一个模块等待另一个模块接口的情况。
需求负责人在写概要设计文档时，把模板中蓝色斜线字体文字去掉，另外注意标注为【必须】的标题栏是不能删减的，意味着写文档时这些内容不能缺失，设计人员要把问题尽量考虑清楚，本模板也是提供一个思考思路，按照标题栏中每项内容进行填写。
发起评审时请指派评审组长为项目SE或工作组长，QA和SE、工作组长对概要设计规范性进行审核；
1.1	编写目的【必须】
本文对XX功能进行描述，描述了哪些过程，用于指导开发功能；
该文档定义好相应的模块之间的外部接口，理清楚模块之间的交互逻辑，提供开发人员的工作效率，减少因为开发之前考虑不周全而导致的设计变更与开发推倒重来，也便于项目管理人员的跟踪。可以一个需求一个设计文档，也可以多个需求在一个文档中进行体现。
本文当的预期读者为需求的各模块开发人员、测试人员和项目管理人员。
1.2	需求背景【必须】
开发该功能的原因介绍，是市场需求还是内部优化。
	该需求是什么项目中的，为什么要做这个事情？主要的用户场景是什么？客户问题是什么？
实现了该功能能带来哪些好处？解决了哪些问题？以表格的形式进行展示
序号	需求	需求描述（包含用户场景）	收益（解决的客户问题或者带来的好处）
1	支持智能融合描红功能	在电警应用模式下，通过双快门方案，低快门保证信号灯曝光正常，红色显示正常，高快门为正常预览快门，红灯过曝偏黄，对信号灯区域进行融合，得到一个红色正常的图像效果。	对于闯红灯车辆的取证图片能够减少争议，更加符合取证规范
			

1.3	需求分析【必须】
罗列清楚该功能是为了解决哪些问题，最终要做成什么样子，输出结果如何？
需求介绍	需求约束
	性能指标	
	兼容性要求	
	适用机型	
1.4	术语和缩写【必须】
术语/缩写	含    义
	
	
	
1.5	参考资料【必须】



2.	总体架构
2.1	系统说明【必须】
这里描述该功能用户的交互流程以及内部模块之间的数据流图，从总体概念上阐述用户如何去操作，操作后内部数据流经过哪些模块，每个模块输出什么内容，最终数据流走到哪个模块，然后呈现给操作用户的内容是什么。通过从总体上的概述，便于开发人员知道要涉及的模块，以及对功能的流程的把握。
【举例说明】
通过1.2节中的描述可知，检索模块主要为回放功能和文件管理功能提供视频和图片文件筛选服务，回放功能和文件管理功能与检索模块有关的数据流图如图2.1-1所示。
首先，GUI模块将用户操作转化为检索条件，发送给检索模块，检索模块对检索条件进行分类和细化处理后，发送给存储模块执行数据库查询，并将查询结果返回给检索模块，检索模块根据GUI的请求，返回包括文件统计信息（文件个数、月历、进度条等）、文件详细信息；
然后，GUI根据用户操作向回放模块发送相关的解码命令，回放模块从检索模块获取文件详细信息，并从硬盘中读取图片或者视频数据，发送给DSP；
最后，DSP将接收到的数据进行解码，视频画面直接显示给用户，缩略图的RGB数据交给GUI显示给用户。
 图2.1-1 回放功能和文件管理数据流图
2.2	运行环境【必须】
这里描述该功能运行的软件环境、硬件环境，软件环境如使用多少位的什么操作系统，有什么依赖的，有什么限制的软件；硬件环境如平台版本，功能对硬件有什么依赖，有什么是需要限制的。
软件运行环境
操作系统	
内存	
Flash	
开发语言	
硬件运行环境
平台代号	
硬件主板	选填

2.3	总体结构及模块划分【必须】
这里写实现该功能要划分的多个模块，以及列出每个模块实现的功能，用来做什么用，再说明下模块与模块之间的关系。理清楚有几个模块以及每个模块之间的关系，有利于不同模块开发资源的调度，工作量的评估，后续对于需求负责人、模块负责人的进度跟踪起到关键作用。
【举例说明】
模块编号	模块名称	模块来源
PD-001	文件管理	新增
PD-002	回放筛选	新增
PD-003	存储接口检索适配层	新增

检索模块与其他模块层次关系及模块内部结构如图2.4-1所示。其中检索模块内部可划分为：文件管理、回放筛选、存储接口适配层三部分。
存储检索接口适配层：屏蔽不同存储检索接口的差异；将检索模块内部调用存储接口的公用部分提取出来。
文件管理模块：主要实现文件管理中已存储的文件、车牌、人脸信息统计与获取。
回放过滤模块：根据用户输入的条件，筛选出符合条件的视频数据。
例1：
  
例2：
 

2.4	资源消耗【必须】
这里列举实现该功能需要消耗的资源情况，不限于内存、:flash空间、socket套接字、fd文件句柄、消耗的CPU等内容。其中内存消耗为必填项。资源的消耗统计不仅限于写该文档的需求负责人所开发的模块，需要包括实现该功能所有模块所消耗的资源，后期要不断更新该表格。
【举例说明】
资源类型	数量	用途	来源
内存	5M	用于保存从数据库检索出来的数据记录，按100个字节计算；一次性最多可保存检索结果为50 000；	新增
Flash			
其他		具体需求来进行补充，例如：A算法需要1颗NNIE,1颗DSP	
2.5	尚未解决的问题【必须】
这里罗列开发中可能会遇到的问题，开发瓶颈，关联资源，会阻塞用户开发；罗列功能开发的一些限制，如哪些功能不处理，哪些功能处理不了，以及哪些功能暂时先以一种简单的方案实施，后续需要优化的。
【举例说明】
1.	ICR切换中滤光片切换位置的稳定性
ICR滤光片设计只在一边端点处有光电开关检测是否移动到位，设备结构生产差异以及随着设备的使用时间加长，可能会出现移动失步的情况。而我们从一端移动到光电开关端是可以保证的，但是从光电开关端移动到对端时，是移动固定步长，此时如果失步较多，就会出现滤光片移动位置不到位的问题，软件暂时无有效手段处理。


3.	DFX属性设计
3.1	可测试性【必须】
可测试性DFT：方便测试部测试的需求设计，主要描述如何构造该需求的操作环境，如何衡量需求的实现程度。如IO线圈抓拍功能，可以按键开关的方式接入相机的触发输入口，通过按键模拟线圈触发，查看抓拍结果。
3.2	维护【必须】
方便技术支持对功能的维护，如收集信息，调试设备。例如相机的死机问题原因很难排查，我们再DFX需求中增加记录设备死机前的状态信息（dump文件），在设备启动后我们导出该状态信息文件，就可以快速排查设备的可能死机原因。
3.3	可配置设计【选填，DSP 、BSP涉及，APP不涉及】
这里指功能的可配置性，不同的硬件平台需要的功能不一样，有的需要有的不需要，通过功能宏进行控制，要做到开发人员的可配置性，通过命令打开或者关闭该功能；
【举例说明】
检索模块功能可以通过menuconfig菜单配置，其中
1.“SUPPORT SEARCH_V40”表示是否支持4.0 检索功能（对应的宏定义为CONFIG_SUPPORT_SEARCH_V40）
3.4	安全设计【必须】
产品安全涉及多个维度：终端安全、数据安全、应用安全、网络安全、隐私保护等。如设备启动的加密芯片验证、数据的存储信息加密、数字水印、交互的身份认证、传输的端口安全、IP地址过滤等等。根据自己文档涉及到的需求具体来进行描述。
例如：抓拍图片中防篡改，我们加入水印功能。
3.5	可制造性【必须】
此处填写实现需求是否有生产制造时的测试需求，着重描述测试方式、结果以及测试时间。如相机的ICR切换功能，在生产装配后，需要工厂测试验证功能以及器件正常。
4.	模块概要说明
此处填写多个功能的描述，每个功能可以是需求分解文档中的一个DR，针对该功能点描述功能实现的目的，架构设计，处理流程，以及实现该功能需要的各个模块提供的外部接口。
4.1	文件管理描述
此处填写新增或者修改的功能描述，更细致的讲解做这个事情用来做什么用，模块输入是什么，输出是什么。
【举例说明】
回放过滤模块主要是根据用户输入的条件，筛选出符合条件的视频数据，以及根据回放模块的请求，检索到需要回放的视频片段。
在本地回放中，可按照时间、通道、空间、属性、线索5个维度对视频数据进行检索，检索结果包括：回放进度条、检索结果缩略图、视频数据月历状态。
补充表格说明，该模块涵盖哪些DR
4.1.1	框架设计以及处理流程【必须】
4.1.1.1 增加子功能描述
此处描写新增或者修改的功能里面的处理流程，整体的架构设计，处理流程中需要以模块为单位进行划分，在流程图中标注需要提供模块外部接口的地方，便于接口的提前设计。注意这里不需要画详细的内部实现流程，需要理清楚模块之间的接口即可。
【举例说明】
回放进度条获取和视频数据筛选的时序图如图3.2.2-1所示。而回放模块获取视频片段信息的时序图如图3.2.2-2所示。
 3.2.2-1GUI筛选回放结果时序图
 3.2.2-2回放获取视频片段时序图
根据1.2节的需求分析和图3.2.2-1回放视频文件筛选时序图，回放文件筛选的处理流程图如图3.2.2-3所示。对于存储返回的检索结果，当检索条件中包括人脸属性或者车牌属性时，返回智能图片文件信息；否则，返回视频文件信息。
视频数据月历状态获取时序图如图3.2.2-5所示。
 图3.2.2-5回放月历获取时序图
4.1.2	子模块划分列表
子模块编号	子模块名称	是否关键模块
PD-001-001	人脸图集	是
PD-001-002	车牌图集	是
PD-001-003	文件管理	是
4.1.3	子模块设计说明
描述该子模块实现的功能描述，必要时可结合流程图进行说明。
4.1.4	内部接口
4.1.4.1	对内接口1
函数功能	
函数名称	
输入参数	N/A
输出参数	N/A
返回值	HPR_OK:成功 HPR_ERROR:失败
处理流程	
4.1.4.2	对内接口2
函数功能	
函数名称	
输入参数	N/A
输出参数	N/A
返回值	HPR_OK:成功 HPR_ERROR:失败
处理流程	
4.1.5	异常处理
针对本子模块功能的异常处理
4.2	回放筛选描述
4.2.1	功能框架设计以及处理流程
4.2.2	子模块划分列表
子模块编号	子模块名称	是否关键模块
PD-001-001	人脸图集	是
PD-001-002	车牌图集	是
PD-001-003	文件管理	是
4.2.3	子模块设计说明
描述该子模块实现的功能描述，必要时可结合流程图进行说明。
4.2.4	内部接口
4.2.4.1	对内接口1
函数功能	
函数名称	
输入参数	N/A
输出参数	N/A
返回值	HPR_OK:成功 HPR_ERROR:失败
处理流程	
4.2.5	异常处理
5.	对外接口
功能说明	预览统一接口
函数名称	
输入参数（包含隐含输入参数）	参数代码/名称	数据类型	参数说明
			
			
输出参数（包含隐含输出参数）	参数代码/名称	数据类型	参数说明
			
返回值	
处理过程	

6.	参数结构
6.1.1	全局变量

6.1.2	结构体

7.	异常处理
例：在智能算法模块中，需要对于算法运行状态进行监控，在出现视频帧不能够正常进行算法分析时，增加异常处理逻辑，重启设备，以保证设备后续的算法正常运行。
8.	修订记录【必须】
序号	变更时间	版本	变更人	审批人	变更说明
1	2019-3-30	V1.0	李京国		创建&修改会议评审意见

